!function(){"use strict";function t(t,n){return t(n={exports:{}},n.exports),n.exports}var e=t(function(n){function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t){return"function"==typeof Symbol&&"symbol"===e(Symbol.iterator)?n.exports=r=function(t){return e(t)}:n.exports=r=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":e(t)},r(t)}n.exports=r}),x=(e.typeof,function(t){var n=e(t);return null!=t&&("object"==n||"function"==n)}),L=window;function c(r,i,t){var a,c,o,u,s,l,f=0,h=!1,p=!1,n=!0,e=!i&&0!==i&&"function"==typeof L.requestAnimationFrame;if("function"!=typeof r)throw new TypeError("Expected a function");function d(t){var n=a,e=c;return a=c=void 0,f=t,u=r.apply(e,n)}function m(t,n){return e?(L.cancelAnimationFrame(s),L.requestAnimationFrame(t)):setTimeout(t,n)}function y(t){var n=t-l;return void 0===l||i<=n||n<0||p&&o<=t-f}function v(){var t=Date.now();if(y(t))return g(t);s=m(v,function(t){var n=t-f,e=i-(t-l);return p?Math.min(e,o-n):e}(t))}function g(t){return s=void 0,n&&a?d(t):(a=c=void 0,u)}function w(){for(var t=Date.now(),n=y(t),e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];if(a=r,c=this,l=t,n){if(void 0===s)return function(t){return f=t,s=m(v,i),h?d(t):u}(l);if(p)return s=m(v,i),d(l)}return void 0===s&&(s=m(v,i)),u}return i=+i||0,x(t)&&(h=!!t.leading,o=(p="maxWait"in t)?Math.max(+t.maxWait||0,i):o,n="trailing"in t?!!t.trailing:n),w.cancel=function(){void 0!==s&&function(t){if(e)return L.cancelAnimationFrame(t);clearTimeout(t)}(s),a=l=c=s=void(f=0)},w.flush=function(){return void 0===s?u:g(Date.now())},w.pending=function(){return void 0!==s},w}var v=t(function(t){var n=function(i){var u,t=Object.prototype,s=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",e=n.asyncIterator||"@@asyncIterator",r=n.toStringTag||"@@toStringTag";function a(t,n,e,r){var o=n&&n.prototype instanceof c?n:c,i=Object.create(o.prototype),a=new k(r||[]);return i._invoke=function(i,a,c){var u=f;return function(t,n){if(u===p)throw new Error("Generator is already running");if(u===d){if("throw"===t)throw n;return j()}for(c.method=t,c.arg=n;;){var e=c.delegate;if(e){var r=_(e,c);if(r){if(r===m)continue;return r}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(u===f)throw u=d,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);u=p;var o=l(i,a,c);if("normal"===o.type){if(u=c.done?d:h,o.arg===m)continue;return{value:o.arg,done:c.done}}"throw"===o.type&&(u=d,c.method="throw",c.arg=o.arg)}}}(t,e,a),i}function l(t,n,e){try{return{type:"normal",arg:t.call(n,e)}}catch(t){return{type:"throw",arg:t}}}i.wrap=a;var f="suspendedStart",h="suspendedYield",p="executing",d="completed",m={};function c(){}function y(){}function v(){}var g={};g[o]=function(){return this};var w=Object.getPrototypeOf,x=w&&w(w(C([])));x&&x!==t&&s.call(x,o)&&(g=x);var L=v.prototype=c.prototype=Object.create(g);function b(t){["next","throw","return"].forEach(function(n){t[n]=function(t){return this._invoke(n,t)}})}function E(u){var n;this._invoke=function(e,r){function t(){return new Promise(function(t,n){!function n(t,e,r,o){var i=l(u[t],u,e);if("throw"!==i.type){var a=i.arg,c=a.value;return c&&"object"==typeof c&&s.call(c,"__await")?Promise.resolve(c.__await).then(function(t){n("next",t,r,o)},function(t){n("throw",t,r,o)}):Promise.resolve(c).then(function(t){a.value=t,r(a)},function(t){return n("throw",t,r,o)})}o(i.arg)}(e,r,t,n)})}return n=n?n.then(t,t):t()}}function _(t,n){var e=t.iterator[n.method];if(e===u){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=u,_(t,n),"throw"===n.method))return m;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var r=l(e,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,m;var o=r.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=u),n.delegate=null,m):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function S(t){var n={tryLoc:t[0]};1 in t&&(n.catchLoc=t[1]),2 in t&&(n.finallyLoc=t[2],n.afterLoc=t[3]),this.tryEntries.push(n)}function N(t){var n=t.completion||{};n.type="normal",delete n.arg,t.completion=n}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function C(n){if(n){var t=n[o];if(t)return t.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var e=-1,r=function t(){for(;++e<n.length;)if(s.call(n,e))return t.value=n[e],t.done=!1,t;return t.value=u,t.done=!0,t};return r.next=r}}return{next:j}}function j(){return{value:u,done:!0}}return y.prototype=L.constructor=v,v.constructor=y,v[r]=y.displayName="GeneratorFunction",i.isGeneratorFunction=function(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===y||"GeneratorFunction"===(n.displayName||n.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,r in t||(t[r]="GeneratorFunction")),t.prototype=Object.create(L),t},i.awrap=function(t){return{__await:t}},b(E.prototype),E.prototype[e]=function(){return this},i.AsyncIterator=E,i.async=function(t,n,e,r){var o=new E(a(t,n,e,r));return i.isGeneratorFunction(n)?o:o.next().then(function(t){return t.done?t.value:o.next()})},b(L),L[r]="Generator",L[o]=function(){return this},L.toString=function(){return"[object Generator]"},i.keys=function(e){var r=[];for(var t in e)r.push(t);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},i.values=C,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=u,this.done=!1,this.delegate=null,this.method="next",this.arg=u,this.tryEntries.forEach(N),!t)for(var n in this)"t"===n.charAt(0)&&s.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=u)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function t(t,n){return i.type="throw",i.arg=e,r.next=t,n&&(r.method="next",r.arg=u),!!n}for(var n=this.tryEntries.length-1;0<=n;--n){var o=this.tryEntries[n],i=o.completion;if("root"===o.tryLoc)return t("end");if(o.tryLoc<=this.prev){var a=s.call(o,"catchLoc"),c=s.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);if(this.prev<o.finallyLoc)return t(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return t(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return t(o.finallyLoc)}}}},abrupt:function(t,n){for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e];if(r.tryLoc<=this.prev&&s.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=n&&n<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=n,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(i)},complete:function(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),m},finish:function(t){for(var n=this.tryEntries.length-1;0<=n;--n){var e=this.tryEntries[n];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),N(e),m}},catch:function(t){for(var n=this.tryEntries.length-1;0<=n;--n){var e=this.tryEntries[n];if(e.tryLoc===t){var r=e.completion;if("throw"===r.type){var o=r.arg;N(e)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,e){return this.delegate={iterator:C(t),resultName:n,nextLoc:e},"next"===this.method&&(this.arg=u),m}},i}(t.exports);try{regeneratorRuntime=n}catch(t){Function("r","regeneratorRuntime = r")(n)}});var n=function(t){if(Array.isArray(t)){for(var n=0,e=new Array(t.length);n<t.length;n++)e[n]=t[n];return e}};var r=function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)};var o=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")};var g=function(t){return n(t)||r(t)||o()};function u(t,n,e,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?n(u):Promise.resolve(u).then(r,o)}function w(){for(var t,n=arguments.length,e=new Array(n),r=0;r<n;r++)e[r]=arguments[r];(t=console).log.apply(t,["LOG:"].concat(e))}var b=function(c){return function(){var t=this,a=arguments;return new Promise(function(n,e){var r=c.apply(t,a);function o(t){u(r,n,e,o,i,"next",t)}function i(t){u(r,n,e,o,i,"throw",t)}o(void 0)})}},i=function(){var t=b(v.mark(function t(){var n,o,i,a,c,u,s,e,l,f,h,p,d,m,y;return v.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(y=function(t){if(t<=0)return"slideleft-in";var n="slideleft-in-withHeightDiff_".concat(t);if(n in l.aniClasses)return n;for(var e=document.createElement("style"),r=Math.random().toString(36).substr(2),o={top:0,left:0,opacity:1,toStyle:function(){return"{\n          top: ".concat(this.top,"px;\n          left: ").concat(this.left,"px;\n          opacity: ").concat(this.opacity,";\n        }\n        ").replace(/[\n\t\s]/g,"")}},i=[],a=p;a<100;a+=h)i.push("".concat(a,"% ").concat(o.toStyle())),0===o.top?o.top=-t:o.top=0;return o.opacity=0,i.push("100% ".concat(o.toStyle())),e.innerHTML="\n    @keyframes keyframes_".concat(r," {\n      ").concat(i.join("\n"),"\n    }\n    .").concat(n," {\n      top: 0;\n      left: 100%;\n      animation:\n        keyframes_").concat(r," ").concat(f,"s linear .5s 1 alternate forwards;\n      -webkit-animation:\n        keyframes_").concat(r," ").concat(f,"s linear .5s 1 alternate forwards\n    }\n    ").replace(/[\n\t]/g,""),document.head.appendChild(e),l.aniClasses[n]=1,n},m=function(n){return new Promise(function(i,t){var a=new Image;a.onload=function(){a.onload=null;var t=a.naturalHeight,n=a.naturalWidth,e=Math.floor(t*u/n),r=y(e-s),o=document.createElement("div");o.className="ad__img",o.classList.add(r),o.appendChild(a),i(o)},a.onerror=t,a.src=n})},window.fetch){t.next=4;break}return t.abrupt("return",w("Your broswer doesn't support this script."));case 4:return t.next=6,fetch("https://plants2019.oss-cn-shenzhen.aliyuncs.com/202007.index");case 6:return n=t.sent,t.next=9,n.text().then(function(t){return t.split("BOUNDARY-------------------------").map(function(t){return JSON.parse(t)}).map(function(t){return"".concat(t.key,".plant/meta")})}).then(function(t){return Promise.all(t.map(function(t){return fetch("https://plants2019.oss-cn-shenzhen.aliyuncs.com/".concat(t)).then(function(t){return t.json()})}))}).then(function(t){return t.map(function(t){var n=t.pictures,o=t.key;return n.map(function(t){var n=t.text;if(!n&&t.loc&&t.loc.t){var e=t.loc.t,r=e.streetNumber?e.streetNumber.street:"";n=e.province+e.city+e.district+e.township+r}else n="No words";return{title:n+="@"+new Date(t.date).toLocaleDateString(),src:"https://plants2019.oss-cn-shenzhen.aliyuncs.com/".concat(o,".plant/").concat(t.key,".jpg")}})})}).then(function(t){var n=[];return t.forEach(function(t){n.push.apply(n,g(t))}),n});case 9:o=t.sent,i=o.length,a=document.querySelector("#ref_adImgs"),(c=document.createElement("div")).className="ad__img-title",c.textContent="",c.addEventListener("click",function(){var t=l.i-1,n=o[t].detail;n&&window.open(n,"_blank")}),a.addEventListener("click",function(t){if(t.stopPropagation(),t.target instanceof Image){var n=l.i-1,e=o[n].src;showPhotoModal(e)}}),a.appendChild(c),a.querySelector(".ad__next").addEventListener("click",function(){l.requestNext=1,l.cur&&l.cur.classList.add("interrupt")}),u=a.clientWidth,s=a.clientHeight,e=Number(localStorage.getItem("CURRENT_AD_INDEX")),l={i:e,requestNext:0,cur:null,aniClasses:{}},f=60,h=20,p=5,(d=function(){var t=b(v.mark(function t(){var n,e,r;return v.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return l.i>=i&&(l.i=0),n=l.i,w("iter",n),localStorage.setItem("CURRENT_AD_INDEX",n),c.textContent="loading...",c.style.color="#456",c.classList.add("ad__img-title--loading"),e=o[n].src,t.next=10,m(e);case 10:(r=t.sent).addEventListener("animationend",function(t){var n=t.animationName;w("end",n),l.cur=null,a.removeChild(t.currentTarget),d()}),r.addEventListener("mouseenter",function(t){t.currentTarget.classList.add("paused")}),r.addEventListener("mouseleave",function(t){t.currentTarget.classList.remove("paused")}),a.appendChild(r),c.classList.remove("ad__img-title--loading"),c.textContent=o[n].title,c.style.color=o[n].tcolor||"#456",setTimeout(function(){c.style.color=o[n].tcolor||"#fff"},1e3),l.i+=1,l.cur=r;case 21:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}())();case 28:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}();window.showPhotoModal=function(t){var n=document.createElement("div"),e=0;function r(){document.body.removeChild(n),document.querySelector("#page").classList.remove("blur"),window.removeEventListener("resize",a)}n.className="photo-modal",n.addEventListener("click",function(){s.style="width: 0; height: 0; opacity: .5;",e=1});var o,u=document.createElement("div");u.className="photo-modal__content",u.innerHTML="loading...",n.appendChild(u),n.appendChild(((o=document.createElement("a")).href="javascript:void(0);",o.target="_self",o.textContent="关闭",o.onclick=r,o.className="photo-modal__close",o)),document.body.appendChild(n),document.querySelector("#page").classList.add("blur");var s=new Image;function i(){var t=u.clientWidth-20-12,n=u.clientHeight-20-12,e=t*f/n>>0,r=s.naturalWidth,o=s.naturalHeight,i=r*f/o>>0,a=0,c=0;r<=t?o<=n?(a=r,c=o):a=l(i*(c=n)/f):o<=n?c=l((a=t)*f/i):i<e?a=l(i*(c=n)/f):c=l((a=t)*f/i),s.style="width: ".concat(a,"px; height: ").concat(c,"px;")}s.style="width: 0; height: 0;";var l=Math.round,f=1024,a=c(i,300);window.addEventListener("resize",a),s.addEventListener("transitionend",function(t){e&&(r(),e=0)}),s.onload=function(){u.innerHTML="",u.appendChild(s),i()},s.src=t},i()}();
