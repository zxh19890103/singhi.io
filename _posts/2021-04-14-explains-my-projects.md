---
layout: post
title: STAR 法则介绍我做过的项目 - P 项目
short: 我要介绍下我做过的项目，项目不难，但是都加入了自己的思想，我想把它说出来，以升华自己的思想
---

从 2020 年 03 月，我加入 XX 团队，参与到 P 项目的迭代工作中。

我们 C 小组大约有 7 个开发，前端有 4 个。

### 背景

P 项目很早就启动了，我参与迭代的时候，其已经相当的成熟。P 项目实现的是一个 B 端商城，项目规模十分宏大，整个部门围绕它划分了 4 个组，我们 C 组主要负责的是大客户这部分的业务功能。我下边主要讲下整个前端项目的架构以及这部分业务。

#### 项目架构

P 项目基于 Vue 2.0 + VueRouter 开发、webpack 打包，以 element UI 为基础的 yUI 组件库。应用基于卡片式架构，有自己的启动引擎，核心代码封装在 app.js。通常一个页面就是一个组件，用 webpack 以 umd 规范打包并混淆之后，上传到 CDN。运营端有一个页面设计器，用于构建前端页面，构建页面就是将卡片放进布局容器中。本人实现了一个简单的卡片式架构引擎，您可前往 [Codepen](https://codepen.io/singhijohn/project/editor/ZRRWeN#) 查看，演示链接：

[https://000252617.codepen.website/card-style/?d=1618487271672#/](https://000252617.codepen.website/card-style/?d=1618487271672#/)

src 目录规划：
  - src/
    - shared/
    - cards/
      - site001/
        - component001/
        - component002/
        - component003/
      - site002/
        - component004/
        - component005/
        - component006/

对于每个组件目录，需要有一个 index.js 文件，暴露出组件配置对象：

```js
import Component from "./card.vue"
export default Component
```

#### 问题

没有引入卡片版本控制机制。

对于公共组件的更新，将涉及多张卡片的重新打包和发布，步骤繁琐！

建议分离 chunk。

#### 开发流程
  1. 创建菜单：url、权限、主题、等
  2. 创建卡片源文件：在 src 目录下新建 vue 组件
  3. 业务开发完成
  4. webpack 打包为 js 卡片资源
  5. 到运营端注册一个卡片，并上传卡片资源
  6. 设计页面：布局、卡片实例权限、页面权限、等
  7. 预览

#### 核心概念
  - 应用（app）：整个
  - 站点（group）：由主题、权限、语言组成
  - 菜单：树形结构、用于站点导航，菜单项包含“布局”、“链接”、“节点” 3 种类型
  - 页面（page）：挂在菜单的（布局）节点上
  - 卡片：注册到系统的组件文件，可在页面实例化，实例化之后称为卡片实例
  - 用户：用于访问 webapp 的站点的身份，可以是 w3 账号，也可以是 uniportal 账号
  - 权限：可以称为用户类型，用于限定站点、页面、卡片的访问
  - 用户权限：站点 + 角色 [+ 公司]
  - 菜单权限：针对角色，有权限方能显示
  - 页面权限：角色是否能访问到这个页面
  - 卡片实例权限：角色是否能访问到这个页面上的此卡片实例

#### 关键特性（我参与过的）
- BP 站点
  1. 购物车
  2. 提交订单
  3. 分批发货
  4. 送货预约（2 个前端）
  5. 退换货

- BP 财经站点
  1. 发票核销（重度优化，组件拆分，业务逻辑整理）
  2. 激励对账（3 个前端）

